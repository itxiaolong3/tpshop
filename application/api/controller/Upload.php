<?php/** * Created by PhpStorm. * User: Administrator * Date: 2018/12/25 * Time: 11:49 */namespace app\api\controller;class Upload extends Base{    public function addImgae(){        $name = I('post.fileName');        if ($_FILES[$name]['tmp_name']) {            $file = $this->request->file($name);            $image_upload_limit_size = config('image_upload_limit_size');            $validate = ['size'=>$image_upload_limit_size,'ext'=>'jpg,png,gif,jpeg'];            $dir = UPLOAD_PATH.$name.'/';            if (!($_exists = file_exists($dir))){                $isMk = mkdir($dir);            }            $parentDir = date('Ymd');            $info = $file->validate($validate)->move($dir, true);            if($info){                return returnOk('/'.$dir.$parentDir.'/'.$info->getFilename());            }else{                $this->error($file->getError());//上传错误提示错误信息            }        }    }    //我新增的图片上传    public function uploadImg()    {        $return_imgs = '';        if ($_FILES['return_imgs']['tmp_name']) {            $files = request()->file("return_imgs");            if (is_object($files)) {                $files = [$files]; //可能是一张图片，小程序情况            }            $image_upload_limit_size = config('image_upload_limit_size');            $validate = ['size'=>$image_upload_limit_size,'ext'=>'jpg,png,gif,jpeg'];            $dir = UPLOAD_PATH.'mechanism/';            if (!($_exists = file_exists($dir))){                $isMk = mkdir($dir);            }            $parentDir = date('Ymd');            foreach($files as $key => $file){                $info = $file->rule($parentDir)->validate($validate)->move($dir, true);                if($info){                    $filename = $info->getFilename();                    $new_name = '/'.$dir.$parentDir.'/'.$filename;                    $return_imgs[]= $new_name;                }else{                    return ['status' => -1, 'msg' => $file->getError()];//上传错误提示错误信息                }            }            if (!empty($return_imgs)) {                $return_imgs = implode(',', $return_imgs);// 上传的图片文件            }        }else{            returnBad('上传失败');        }       echo json_encode(array('code'=>1,'msg'=>'上传成功','imgpath'=>$return_imgs));    }}